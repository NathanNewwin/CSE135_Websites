<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Echo Language Form</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <h2>Echo Endpoint Tester</h2>
    
    <noscript>
        <p class="noscript-msg">JavaScript is disabled. The form will default to POST /echo with URL encoding.</p>
    </noscript>

    <form id="echoForm" action="/echo" method="POST">
        <div class="form-group">
            <label for="language">Target Language (Endpoint):</label>
            <select id="language" name="language">
                <option value="/echo-python">Python (/echo)</option>
                <option value="/echo-nodejs">NodeJS (Demo only)</option>
            </select>
        </div>

        <div class="form-group">
            <label for="httpMethod">HTTP Method:</label>
            <select id="httpMethod" name="httpMethod">
                <option value="GET">GET</option>
                <option value="POST" selected>POST</option>
                <option value="PUT">PUT</option>
                <option value="DELETE">DELETE</option>
            </select>
        </div>

        <div class="form-group">
            <label for="encoding">Encoding:</label>
            <select id="encoding" name="encoding">
                <option value="application/x-www-form-urlencoded">x-www-form-urlencoded</option>
                <option value="application/json">application/json</option>
            </select>
        </div>

        <div class="form-group">
            <label for="message">Data Field (Message):</label>
            <input type="text" id="message" name="message" value="Hello World">
        </div>

        <button type="submit">Submit Request</button>
    </form>

    <h3>Response:</h3>
    <pre id="responseOutput">Submit the form to see the echo response...</pre>

    <script>
        document.getElementById('echoForm').addEventListener('submit', function(e) {
            // Prevent default form submission to handle via JS
            e.preventDefault();

            const form = e.target;
            const output = document.getElementById('responseOutput');
            
            const endpoint = document.getElementById('language').value;
            const method = document.getElementById('httpMethod').value;
            const encoding = document.getElementById('encoding').value;
            
            // Gather form data
            const formData = new FormData(form);
            const dataObj = Object.fromEntries(formData.entries());

            let fetchOptions = {
                method: method,
                headers: {}
            };

            // Setup Body and Headers based on encoding
            if (method !== 'GET') {
                if (encoding === 'application/json') {
                    fetchOptions.headers['Content-Type'] = 'application/json';
                    fetchOptions.body = JSON.stringify(dataObj);
                } else {
                    // URL Encoded
                    fetchOptions.headers['Content-Type'] = 'application/x-www-form-urlencoded';
                    fetchOptions.body = new URLSearchParams(dataObj).toString();
                }
            } else {
                // GET request handles data via URL params
                const params = new URLSearchParams(dataObj).toString();
                // Actual request logic would append params to endpoint
            }

            output.textContent = "Sending request...";

            // Note: In a real environment, 'endpoint' would be prepended with your server URL
            fetch('http://127.0.0.1:5000/echo', fetchOptions)
                .then(res => res.json())
                .then(data => {
                    output.textContent = JSON.stringify(data, null, 2);
                })
                .catch(err => {
                    output.textContent = "Error: " + err.message + "\n(Make sure the Python server is running!)";
                });
        });
    </script>
</body>
</html>